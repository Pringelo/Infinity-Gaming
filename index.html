<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Infinity Gaming — Ładowanie</title>
<style>
    /* Prosty, niezawodny styl bez zewnętrznych fontów */
    html,body{height:100%;margin:0;padding:0;background:#000;color:#fff;font-family:Arial,Helvetica,sans-serif;}
    .bg{position:fixed;inset:0;background:url('https://i.imgur.com/3QXx1hM.jpg') center/cover no-repeat;filter:brightness(0.35);}
    .stars{position:fixed;inset:-50% 0 0 -50%;width:200%;height:200%;background-image:url('https://i.imgur.com/5KXKX9C.png');background-repeat:repeat;opacity:0.35;animation:drift 60s linear infinite;pointer-events:none}
    @keyframes drift{from{transform:translate(0,0)}to{transform:translate(-500px,-500px)}}
    .wrap{position:relative;z-index:2;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:20px}
    h1{font-size:48px;margin:0 0 8px 0;letter-spacing:2px;text-shadow:0 0 18px #00b7ff}
    .subtitle{font-size:14px;opacity:0.9;margin-bottom:18px}
    .loader{width:90px;height:90px;border-radius:50%;border:8px solid rgba(255,255,255,0.12);border-top-color:#00b7ff;animation:spin 1.1s linear infinite;margin-bottom:10px}
    @keyframes spin{to{transform:rotate(360deg)}}
    #status{font-size:18px;margin-top:6px}
    #file{font-size:13px;margin-top:6px;opacity:0.95}
    #progress{font-size:13px;margin-top:4px;opacity:0.9}
    .logo{position:absolute;top:18px;left:18px;font-weight:bold;background:rgba(0,0,0,0.35);padding:8px 12px;border-radius:8px}
    /* mobile tweaks */
    @media(max-width:480px){h1{font-size:28px}.loader{width:64px;height:64px}}
</style>
</head>
<body>

<!-- Tło i efekt gwiazd -->
<div class="bg" aria-hidden="true"></div>
<div class="stars" aria-hidden="true"></div>

<div class="logo">Infinity Gaming</div>

<div class="wrap">
    <h1 id="servername">Infinity Gaming</h1>
    <div class="loader" role="img" aria-label="Ładowanie"></div>
    <div class="subtitle" id="mapname">Ładowanie mapy...</div>
    <div id="status">Ładowanie...</div>
    <div id="file"></div>
    <div id="progress"></div>
</div>

<!-- Muzyka: zewnętrzne źródło royalty-free. GMod powinien zezwolić na autoplay w ładowaniu, ale niektóre klienty mogą blokować dźwięk — obsługujemy to bezpiecznie. -->
<audio id="music" src="https://cdn.pixabay.com/audio/2022/03/15/audio_8e3cf3a039.mp3" loop preload="auto"></audio>

<script>
// --- Funkcje wymagane przez Garry's Mod ---
// Wszystkie funkcje przypisujemy do window, żeby GMod je widział.

window.GameDetails = function(servername, serverurl, mapname, maxplayers, steamid, gamemode, volume, language) {
    try{
        // Ustawienia tekstowe
        document.getElementById('servername').textContent = servername || 'Infinity Gaming';
        document.querySelector('.logo').textContent = servername || 'Infinity Gaming';
        document.getElementById('mapname').textContent = mapname ? ('Mapa: ' + mapname) : 'Mapa: --';

        // Muzyka: ustaw głośność z parametru volume (0..1)
        var aud = document.getElementById('music');
        if(aud){
            aud.volume = (typeof volume === 'number') ? Math.max(0, Math.min(1, volume)) : 0.5;
            // Niektóre przeglądarki blokują autoplay — spróbuj odtworzyć, ale nie przerywaj jeśli błąd
            var p = aud.play();
            if(p && typeof p.then === 'function'){
                p.catch(function(){ /* autoplay zablokowany - zostaw bez erroru */ });
            }
        }

    }catch(e){console.warn('GameDetails error', e)}
};

window.SetFilesTotal = function(total){
    try{
        window._gmd_total = Number(total) || 0;
        window._gmd_needed = window._gmd_total;
        document.getElementById('progress').textContent = 'Pliki: 0 / ' + window._gmd_total;
    }catch(e){console.warn('SetFilesTotal', e)}
};

window.DownloadingFile = function(fileName){
    try{
        document.getElementById('file').textContent = fileName ? ('Pobieranie: ' + fileName) : '';
    }catch(e){console.warn('DownloadingFile', e)}
};

window.SetFilesNeeded = function(needed){
    try{
        needed = Number(needed) || 0;
        window._gmd_needed = needed;
        var total = window._gmd_total || 0;
        var downloaded = Math.max(0, total - needed);
        document.getElementById('progress').textContent = 'Pliki: ' + downloaded + ' / ' + total;
    }catch(e){console.warn('SetFilesNeeded', e)}
};

window.SetStatusChanged = function(status){
    try{
        document.getElementById('status').textContent = status || 'Ładowanie...';
    }catch(e){console.warn('SetStatusChanged', e)}
};

// Optional: pokaż informację jeśli nic się nie dzieje — przydatne przy debugowaniu
setTimeout(function(){
    if(!window._gmd_total){
        // brak wywołań z GMod w ciągu kilku sekund — to może być normalne w trybach lokalnych
        // nie pokazujemy błędu, ale można odkomentować poniższą linijkę do debugowania:
        // document.getElementById('status').textContent = 'Oczekiwanie na serwer...';
    }
},3500);

</script>

</body>
</html>
